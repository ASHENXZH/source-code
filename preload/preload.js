module.exports=function(){const e=require("./paths.js"),{ipcRenderer:t}=require("electron"),{domContentLoadedThen:o,createArrayOf:n,getHostname:i,arrayShuffle:r}=require("./util.js"),{onLogin:s,isLoggedIn:a,onAutoLogin:c}=require("./login.js"),{getUsableScoreMethods:l,getTheGapOf:u,showScore:g}=require("./score.js"),{lock:d,unlock:h,islocked:f}=require("./lock.js"),{TaskList:p,taskBundles:m}=require("./tasks.js"),k=require("./update.js"),q=["oapi.dingtalk.com","login.dingtalk.com","h5.dingtalk.com"],j="https://login.dingtalk.com/login/index.htm?goto="+encodeURIComponent(e.passwdLoginPage);o(async()=>{const o=t.sendSync("getAutoLoginSettings");if(location.href.startsWith(e.loginPage))return void s();if(location.href.startsWith(j)&&o)return void c(o);if(q.includes(i()))return;if(!a())return void(location.href=o?j:"https://pc.xuexi.cn/points/login.html?ref=https://www.xuexi.cn/");if(!f()){k();const[t,o,i,s]=await l();p.clear();let a=[];if(a.push(...n(m[1],u(t)),...n(m[2],u(i))),a.push(...n(m[4],u(o)),...n(m[5],u(s))),0==a.length)return;if(a=r(a),p.add(...a.reduce((e,t)=>e.concat(t),[])),d(),location.href.startsWith(e.myStudyPage))return void(location.href=e.homePage)}g();const L=p.getAll();p.doAll(L),0==L.length&&h()})}();